---
title: "R Notebook"
---

L'installation des packages nécessaires
```{r}
install.packages("plm", repos="http://R-Forge.R-project.org")
```

Le chargement des librairies nécessaire

```{r}
library(dplyr)
library(caTools)
library(randomForest)
library(Amelia)
library(ggplot2)
library(plotly)
library(ggthemes)
```

```{r}
# Importer les donnée qui ont dans le fichier Omrane.csv qui est dans la même répertoire
data <- read.csv(file = "./Omrane.csv", header = TRUE, sep="\t", dec=",")
data$X <- NULL
# les premières observations des données
head(data, n=3)

# les dernières observations des données
tail(data)


print(paste("Nombre d'observations",nrow(data) , sep = " "))
print(paste("Nombre de colonnes:",ncol(data)  , sep = " "))

# La structure des attributs
str(data)

# Statiques de bases sur l'ensemble des attributs
summary(data)
#describe(data)

# Les valeurs non-observés pour chaque attribut
missmap(data)

```


Pre-Processing, correction et nettoyage des données

```{r}

# generer une liste des indexes aléatoires
shuffle_index <- sample(1:nrow(data))

# On va utiliser ses indexes pour mélanger les donnée
data <- data[shuffle_index, ]

# Conversion de la variable cible d'une forme numérique au forme catégorielle 
#data <- mutate(data, Potability = factor(Potability, levels = c(0, 1), labels = c('No', 'Yes')))
glimpse(data)


set.seed(2) #2 représente 20% de chaque groupe
n = 700 
sample= data[sample(1:nrow(data),n), ]

```


EDA Explatory Data Analysis
```{r}
# 1.0 EDA REPORT
library(tidyverse)
library(DataExplorer)
library(corrplot)

# EDA with DataExplorer
config <- configure_report(
  #add_plot_str = FALSE,
  #add_plot_qq = FALSE,
  add_plot_prcomp = FALSE,
  #add_plot_boxplot = FALSE,
  #add_plot_scatterplot = FALSE,
  global_ggtheme = quote(theme_minimal(base_size = 14))
)

data %>% create_report(
  output_file = "Omrane_Population_Report",
  #y="Description",
  report_title = "EDA Report - Omrane Population",
  config = config
)

sample %>% create_report(
  output_file = "Omrane_Sample_Report",
  #y="Description",
  report_title = "EDA Report - Omrane Sample",
  config = config
)

# 2.0 Data Introduction
data %>% introduce()
data %>% plot_intro()

# 3.0 Missing Values

data %>% plot_missing()
data %>% profile_missing()

# 4.0 Continuous Features

data %>% plot_density()
data %>% plot_histogram()

# 5.0 Categorical Features (Explore Categorical Variables with Fisher's & Chi-Square)

data %>% plot_bar()
plot_bar(data, by = "Description")

# 6.0 Relationship

data %>% plot_correlation()


# 7.0 Slicing & dicing
# plot_scatterplot(data, by = "Description", sampled_rows = 1000L)


library(SmartEDA)
library(ISLR)
library(ggstatsplot)

ExpCatViz(
  data %>%
    select(Description, TotalAvances),
  target="Description"
)


mdata = cor(data)

corrplot(mdata, method="circle")


ggbarstats(data = sample, x = Description, y= TotalAvances, labels= "both")
```





























Machine Learning Model

```{r}
set.seed(2) #2 représente 20% de chaque groupe
sample = sample.split(data, SplitRatio = .80)
sample

# Données d'apprentissage
train_data = subset(data, sample==TRUE)

# Données de test
test_data = subset(data, sample==FALSE)
```
```{r}
model <- lm(Prix.unitaire ~., data = train_data)
summary(model)
pred = predict(model, test_data)
pred
plot(Prix.unitaire, type="l", lty = 1.8, col="red")
```
